import{getContext as e,store as a}from"@wordpress/interactivity";const{state:t,callbacks:i}=a("interaction-boilerplate-creator",{state:{darkTheme:!1,isCreatingBoilerplate:!1,hasCreatedBoilerplate:!1,showMessage:!1},actions:{setContextProperty:a=>{t.showMessage=!1;const s=e();s[a.target.name]=a.target.value,"project_name"===a.target.name&&(s.plugin_name=i.normalizeName(a.target.value)),"block_name"===a.target.name&&(s.plugin_block_name=i.normalizeName(a.target.value))},submitForm:async a=>{a.preventDefault();const s=e();if(s.project_name.trim().length>=5&&i.validateEmail(s.plugin_author_email)){const{blogName:e,apiEndpoint:a,...i}=s;t.showMessage=!1,t.isCreatingBoilerplate=!0;const o=await fetch(`${a}`,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":i.nonce},body:JSON.stringify({...i})}),r=await o.json();if(s.message=r.message+" Logged: "+r.logged_user,200!==r.status)return s.message=r.message+" "+r.logged_user,t.showMessage=!0,void(t.isCreatingBoilerplate=!1);const l=1e3*s.delayCreation;setTimeout(()=>{t.isCreatingBoilerplate=!1,t.hasCreatedBoilerplate=!0,s.plugin_file_name=`${r.plugin_file_name}.zip`,s.downloadLink=r.download_link},l)}else s.message="Insufficient information. Please enter a valid project name and email address.",t.showMessage=!0,t.isCreatingBoilerplate=!1}},callbacks:{hideBlockType:()=>{const a=e();return!a.plugin_type||"without_block"===a.plugin_type},hideForm:()=>t.isCreatingBoilerplate||t.hasCreatedBoilerplate,hideFormSubmittedCreating:()=>!t.isCreatingBoilerplate||t.hasCreatedBoilerplate,hideMessage:()=>!t.showMessage,normalizeName:e=>e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-zA-Z0-9 ]/g,"").replace(/\s+/g," ").trim(),validateEmail:e=>/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(e)}});export{i as callbacks,t as state};